<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Enhanced SEO Meta Tags -->
    <title>Free Offline Modifications Generator - Create Professional Website Change Notes & Emails | WorkToolsHub</title>
    <meta
      name="description"
      content="Free AI-powered offline modifications generator. Create professional internal notes and client emails for website changes in seconds. Perfect for web developers, agencies, and freelancers. No signup required."
    />
    <meta
      name="keywords"
      content="offline modifications generator, website change notes, client email generator, web development tools, website modification tracker, professional email templates, internal documentation tool, AI content generator, free web tools, site change tracker, fulfillment notes, modification documentation"
    />
    <meta name="author" content="WorkToolsHub" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <link rel="canonical" href="https://www.worktoolshub.info/views/tools/offline-mods-note-email-generator.html" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.worktoolshub.info/views/tools/offline-mods-note-email-generator.html" />
    <meta property="og:title" content="Free Offline Modifications Generator - Website Change Documentation Tool" />
    <meta property="og:description" content="Generate professional internal notes and client emails for website modifications instantly with AI. Free tool for web developers and agencies." />
    <meta property="og:image" content="https://www.worktoolshub.info/assets/icon-512.png" />
    <meta property="og:site_name" content="WorkToolsHub" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://www.worktoolshub.info/views/tools/offline-mods-note-email-generator.html" />
    <meta property="twitter:title" content="Free Offline Modifications Generator Tool" />
    <meta property="twitter:description" content="Create professional website change documentation and client emails instantly with AI" />
    <meta property="twitter:image" content="https://www.worktoolshub.info/assets/icon-512.png" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://www.worktoolshub.info/assets/icon-192.png">
    <link rel="apple-touch-icon" href="https://www.worktoolshub.info/assets/icon-192.png">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://api.openai.com" />
    <link rel="preconnect" href="https://worktoolshubv2.onrender.com" />

    <!-- Styling / CSS -->
    <link rel="stylesheet" href="../styles/main.css" />
    <link rel="stylesheet" href="../styles/tools.css" />

    <style>
      /* Modern, Intuitive Design System - NO CONFLICTING VARIABLES */
      :root {
        --mod-shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --mod-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        --mod-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        --mod-shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
      }

      /* Hero Section */
      .hero-section {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 3rem 1.5rem;
        text-align: center;
        border-radius: 12px;
        margin-bottom: 2rem;
        box-shadow: var(--mod-shadow-xl);
      }

      .hero-title {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 1rem;
        line-height: 1.2;
        color: white;
      }

      .hero-subtitle {
        font-size: 1.25rem;
        opacity: 0.95;
        margin-bottom: 1.5rem;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
        color: white;
      }

      .hero-features {
        display: flex;
        justify-content: center;
        gap: 2rem;
        flex-wrap: wrap;
        margin-top: 1.5rem;
      }

      .hero-feature {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1rem;
        color: white;
      }

      .hero-feature-icon {
        font-size: 1.5rem;
      }

      /* Instruction Card */
      .instruction-card {
        background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
        border: 2px solid #667eea;
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 2rem;
      }

      .instruction-content h3 {
        margin: 0 0 1rem 0;
        color: #667eea;
        font-size: 1.25rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .instruction-steps {
        display: grid;
        gap: 0.75rem;
      }

      .instruction-step {
        display: flex;
        align-items: start;
        gap: 0.75rem;
        padding: 0.75rem;
        background: white;
        border-radius: 8px;
        border: 1px solid #e5e7eb;
      }

      .step-number {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.875rem;
        flex-shrink: 0;
      }

      .step-text {
        color: #6b7280;
        line-height: 1.5;
        font-size: 0.9375rem;
      }

      /* Simplified Page Form */
      .page-form-container {
        background: white;
        border: 2px solid #e5e7eb;
        border-radius: 12px;
        padding: 2rem;
        margin-bottom: 1.5rem;
        box-shadow: var(--mod-shadow-md);
      }

      .page-form-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid #f3f4f6;
      }

      .page-number-badge {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 1.125rem;
        flex-shrink: 0;
        box-shadow: var(--mod-shadow-md);
      }

      .page-form-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: #1f2937;
        margin: 0;
      }

      .remove-page-btn {
        margin-left: auto;
        background: #fee2e2;
        color: #ef4444;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.875rem;
        font-weight: 600;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .remove-page-btn:hover {
        background: #ef4444;
        color: white;
        transform: translateY(-2px);
        box-shadow: var(--mod-shadow-md);
      }

      /* Input Fields */
      .input-group {
        margin-bottom: 1.5rem;
      }

      .input-label {
        display: block;
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 0.5rem;
        font-size: 0.9375rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .input-field {
        width: 100%;
        padding: 0.875rem 1rem;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.2s ease;
        font-family: inherit;
        background: white;
        color: #1f2937;
      }

      .input-field:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        background: #fafafa;
      }

      .input-field::placeholder {
        color: #9ca3af;
      }

      .textarea-field {
        min-height: 120px;
        resize: vertical;
        font-family: inherit;
        line-height: 1.6;
      }

      .input-hint {
        margin-top: 0.5rem;
        font-size: 0.8125rem;
        color: #9ca3af;
        font-style: italic;
      }

      /* Add Page Button */
      .add-page-btn {
        width: 100%;
        padding: 1.25rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 12px;
        color: white;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 2rem;
        font-size: 1.125rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        box-shadow: var(--mod-shadow-lg);
      }

      .add-page-btn:hover {
        transform: translateY(-3px);
        box-shadow: var(--mod-shadow-xl);
      }

      .add-page-btn:active {
        transform: translateY(-1px);
      }

      /* Generate Button */
      .generate-btn {
        width: 100%;
        padding: 1.5rem;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        border: none;
        border-radius: 12px;
        color: white;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 2rem;
        font-size: 1.25rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        box-shadow: var(--mod-shadow-xl);
        position: relative;
        overflow: hidden;
      }

      .generate-btn:hover:not(:disabled) {
        transform: translateY(-3px);
        box-shadow: 0 20px 25px -5px rgba(16, 185, 129, 0.3);
      }

      .generate-btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
      }

      .generate-btn.is-generating {
        background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        pointer-events: none;
      }

      .btn-icon {
        font-size: 1.5rem;
      }

      /* Loading Spinner */
      .loading-spinner {
        display: none;
        align-items: center;
        gap: 0.75rem;
      }

      .spinner {
        width: 24px;
        height: 24px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-top-color: white;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }

      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      /* Results Section - FIXED DISPLAY */
      .results-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin-top: 3rem;
        opacity: 0;
        visibility: hidden;
        transform: translateY(20px);
        transition: opacity 0.5s ease, visibility 0.5s ease, transform 0.5s ease;
      }

      .results-container.visible {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .result-container {
        background: white;
        border: 3px solid #e5e7eb;
        border-radius: 12px;
        padding: 0;
        box-shadow: var(--mod-shadow-lg);
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .result-container:hover {
        transform: translateY(-5px);
        box-shadow: var(--mod-shadow-xl);
      }

      .internal-note-container {
        border-color: #f59e0b;
      }

      .client-email-container {
        border-color: #10b981;
      }

      .result-header {
        padding: 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #f9fafb;
        border-bottom: 2px solid #e5e7eb;
      }

      .internal-note-container .result-header {
        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      }

      .client-email-container .result-header {
        background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
      }

      .result-title {
        font-size: 1.25rem;
        font-weight: 700;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .internal-note-title {
        color: #d97706;
      }

      .client-email-title {
        color: #059669;
      }

      .copy-btn {
        background: #3b82f6;
        color: white;
        border: none;
        padding: 0.625rem 1.25rem;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.875rem;
        font-weight: 600;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        box-shadow: var(--mod-shadow-sm);
      }

      .copy-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--mod-shadow-md);
      }

      .internal-note-copy {
        background: #f59e0b;
      }

      .internal-note-copy:hover {
        background: #d97706;
      }

      .content-preview {
        padding: 1.5rem;
        white-space: pre-wrap;
        font-family: 'Courier New', monospace;
        font-size: 0.875rem;
        line-height: 1.6;
        color: #1f2937;
        background: white;
        max-height: 500px;
        overflow-y: auto;
      }

      /* Custom Scrollbar */
      .content-preview::-webkit-scrollbar {
        width: 8px;
      }

      .content-preview::-webkit-scrollbar-track {
        background: #f1f5f9;
      }

      .content-preview::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
      }

      .content-preview::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }

      /* FAQ Section for SEO */
      .faq-section {
        margin-top: 4rem;
        padding: 2rem;
        background: #f9fafb;
        border-radius: 12px;
      }

      .faq-title {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 2rem;
        text-align: center;
        color: #1f2937;
      }

      .faq-item {
        margin-bottom: 1.5rem;
        background: white;
        padding: 1.5rem;
        border-radius: 8px;
        border: 1px solid #e5e7eb;
      }

      .faq-question {
        font-weight: 700;
        font-size: 1.125rem;
        color: #1f2937;
        margin-bottom: 0.5rem;
      }

      .faq-answer {
        color: #6b7280;
        line-height: 1.6;
      }

      /* Responsive Design */
      @media (max-width: 968px) {
        .hero-title {
          font-size: 2rem;
        }

        .results-container {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .hero-title {
          font-size: 1.75rem;
        }

        .hero-subtitle {
          font-size: 1rem;
        }

        .hero-features {
          flex-direction: column;
          gap: 0.75rem;
        }

        .page-form-header {
          flex-wrap: wrap;
        }

        .remove-page-btn {
          width: 100%;
          margin-left: 0;
          margin-top: 0.5rem;
        }

        .generate-btn {
          font-size: 1.125rem;
          padding: 1.25rem;
        }

        .faq-section {
          padding: 1.5rem;
        }
      }

      /* Empty State */
      .empty-pages {
        text-align: center;
        padding: 3rem 1rem;
        background: #f9fafb;
        border-radius: 12px;
        border: 2px dashed #d1d5db;
      }

      .empty-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      .empty-text {
        font-size: 1.125rem;
        color: #6b7280;
        margin-bottom: 0.5rem;
      }

      .empty-hint {
        font-size: 0.875rem;
        color: #9ca3af;
      }
    </style>

    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Offline Modifications Generator",
        "description": "Free AI-powered tool to generate professional internal notes and client emails for website modifications. Perfect for web developers, agencies, and freelancers.",
        "url": "https://worktoolshub.info/views/tools/offline-mods-note-email-generator.html",
        "applicationCategory": "BusinessApplication",
        "operatingSystem": "Any",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "publisher": {
          "@type": "Organization",
          "name": "WorkToolsHub",
          "url": "https://worktoolshub.info"
        },
        "featureList": [
          "AI-powered content generation",
          "Dual output (internal notes and client emails)",
          "Multiple pages support",
          "Professional email templates",
          "Free to use",
          "No signup required",
          "Instant generation"
        ],
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.8",
          "ratingCount": "156"
        }
      }
    </script>

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
          {
            "@type": "Question",
            "name": "How do I use this tool?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Simply add the pages you modified, list the changes you made on each page, and click generate. The AI will create professional documentation in seconds - both an internal note and a client email."
            }
          }
        ]
      }
    </script>
  </head>
  <body>
    <div id="header"></div>
    <div id="bread"></div>

    <main>
      <section class="tool-container">
        <div id="user-info" style="margin-bottom: 1rem;"></div>
        
        <!-- Hero Section -->
        <div class="hero-section">
          <h1 class="hero-title">‚ú® Website Changes Made Simple</h1>
          <p class="hero-subtitle">
            Create professional documentation for your website modifications in seconds with AI
          </p>
          <div class="hero-features">
            <div class="hero-feature">
              <span class="hero-feature-icon">‚ö°</span>
              <span>Instant Generation</span>
            </div>
            <div class="hero-feature">
              <span class="hero-feature-icon">ü§ñ</span>
              <span>AI-Powered</span>
            </div>
            <div class="hero-feature">
              <span class="hero-feature-icon">üìß</span>
              <span>Dual Outputs</span>
            </div>
            <div class="hero-feature">
              <span class="hero-feature-icon">‚úÖ</span>
              <span>100% Free</span>
            </div>
          </div>
        </div>

        <!-- Instruction Card -->
        <div class="instruction-card">
          <div class="instruction-content">
            <h3>
              <span>üí°</span>
              <span>How It Works</span>
            </h3>
            <div class="instruction-steps">
              <div class="instruction-step">
                <div class="step-number">1</div>
                <div class="step-text">Enter the <strong>page URL or name</strong> (e.g., "Homepage" or "https://example.com/about")</div>
              </div>
              <div class="instruction-step">
                <div class="step-number">2</div>
                <div class="step-text">Type <strong>what you changed</strong> in the text box below (e.g., "Updated hero image" or "Fixed contact form")</div>
              </div>
              <div class="instruction-step">
                <div class="step-number">3</div>
                <div class="step-text">Click <strong>"Add Another Page"</strong> if you modified multiple pages</div>
              </div>
              <div class="instruction-step">
                <div class="step-number">4</div>
                <div class="step-text">Hit <strong>"Generate"</strong> to get both an internal note and a professional client email!</div>
              </div>
            </div>
          </div>
        </div>

        <form id="modificationsForm">
          <div id="pagesContainer">
            <!-- Empty state initially -->
            <div class="empty-pages" id="emptyState">
              <div class="empty-icon">üåê</div>
              <div class="empty-text">Ready to document your changes?</div>
              <div class="empty-hint">Click the button below to add your first page</div>
            </div>
          </div>

          <button type="button" class="add-page-btn" id="addPageBtn">
            <span style="font-size: 1.5rem;">‚ûï</span>
            <span>Add Your First Page</span>
          </button>

          <button type="submit" class="generate-btn" id="generateBtn">
            <span class="btn-content">
              <span class="btn-icon">üöÄ</span>
              <span>Generate</span>
            </span>
            <span class="loading-spinner">
              <div class="spinner"></div>
              <span>Creating magic with AI...</span>
            </span>
          </button>

          <div class="progress-bar" id="progressBar">
            <div class="progress-fill"></div>
          </div>

          <div class="error-message" id="errorMessage"></div>
        </form>

        <div class="results-container" id="resultsContainer">
          <div class="result-container internal-note-container">
            <div class="result-header">
              <h3 class="result-title internal-note-title">
                <span>üìã</span>
                <span>Internal Team Note</span>
              </h3>
              <button class="copy-btn internal-note-copy" id="copyNoteBtn">
                <span>üìã</span>
                <span>Copy</span>
              </button>
            </div>
            <div class="content-preview" id="notePreview">
              Your internal fulfillment note will appear here...
            </div>
          </div>

          <div class="result-container client-email-container">
            <div class="result-header">
              <h3 class="result-title client-email-title">
                <span>üìß</span>
                <span>Client Email</span>
              </h3>
              <button class="copy-btn" id="copyEmailBtn">
                <span>üìã</span>
                <span>Copy</span>
              </button>
            </div>
            <div class="content-preview email-preview" id="emailPreview">
              Your client-facing email will appear here...
            </div>
          </div>
        </div>

        <!-- FAQ Section for SEO -->
        <div class="faq-section">
          <h2 class="faq-title">Frequently Asked Questions</h2>

          <div class="faq-item">
            <div class="faq-question">How do I use this tool?</div>
            <div class="faq-answer">
              Using this tool is simple: (1) Click "Add Your First Page" and enter the webpage URL or page name, (2) In the text box that appears, describe what modifications you made on that page, (3) If you modified multiple pages, click "Add Another Page" and repeat, (4) Click the "Generate" button. The AI will instantly create both an internal note and a professional client email.
            </div>
          </div>

          <div class="faq-item">
            <div class="faq-question">What's the difference between the internal note and client email?</div>
            <div class="faq-answer">
              The internal note is formatted for your team's fulfillment documentation with technical details and next steps. The client email is written in friendly, professional language that's easy for clients to understand, focusing on the value and completion of the work.
            </div>
          </div>

          <div class="faq-item">
            <div class="faq-question">Can I edit the generated content?</div>
            <div class="faq-answer">
              Absolutely! Once generated, you can copy the content and edit it in your preferred text editor or email client. The AI provides a professional starting point that you can customize as needed.
            </div>
          </div>

          <div class="faq-item">
            <div class="faq-question">How many pages can I document at once?</div>
            <div class="faq-answer">
              You can document as many pages as you need! Simply keep clicking "Add Another Page" to add more pages to your documentation. The tool will organize all changes by page in both the internal note and client email.
            </div>
          </div>
        </div>
      </section>
    </main>

    <div id="footer"></div>

    <script src="../scripts/layout.js"></script>
    <script type="module" src="../scripts/main.js" defer></script>
    <script src="/auth-utils.js"></script>
    <script src="../scripts/footer.js"></script>

    <script>
document.addEventListener('DOMContentLoaded', async () => {
  const toolName = 'offline-mods-note-email-generator'; 
  const result = await authUtils.initToolAuth(toolName, 'Offline Mods Note & Email Generator', {
    showUserInfo: true,
    userInfoContainerId: 'user-info' 
  });
  
  if (result.success) {
    class OfflineModificationsGenerator {
        constructor() {
          this.form = document.getElementById("modificationsForm");
          this.generateBtn = document.getElementById("generateBtn");
          this.progressBar = document.getElementById("progressBar");
          this.errorMessage = document.getElementById("errorMessage");
          this.resultsContainer = document.getElementById("resultsContainer");
          this.notePreview = document.getElementById("notePreview");
          this.emailPreview = document.getElementById("emailPreview");
          this.copyNoteBtn = document.getElementById("copyNoteBtn");
          this.copyEmailBtn = document.getElementById("copyEmailBtn");
          this.addPageBtn = document.getElementById("addPageBtn");
          this.pagesContainer = document.getElementById("pagesContainer");
          this.emptyState = document.getElementById("emptyState");

          this.pageCounter = 0;

          this.init();
        }

        init() {
          this.bindEvents();
        }

        bindEvents() {
          this.form.addEventListener("submit", (e) => this.handleSubmit(e));
          this.copyNoteBtn.addEventListener("click", () =>
            this.copyToClipboard("note")
          );
          this.copyEmailBtn.addEventListener("click", () =>
            this.copyToClipboard("email")
          );
          this.addPageBtn.addEventListener("click", () => this.addPage());
        }

        sanitizeUrlInput(url) {
          if (!url) return '';
          
          let cleaned = url.trim();
          
          // Decode common HTML entities
          const entityMap = {
            '&amp;': '&',
            '&lt;': '<',
            '&gt;': '>',
            '&quot;': '"',
            '&#x27;': "'",
            '&#39;': "'",
            '&#x2F;': '/',
            '&#x2f;': '/',
            '&#47;': '/',
            '&sol;': '/',
            '&#x3A;': ':',
            '&#x3a;': ':',
            '&#58;': ':',
            '&colon;': ':',
            '&#x40;': '@',
            '&#64;': '@',
            '&commat;': '@'
          };
          
          for (const [entity, char] of Object.entries(entityMap)) {
            cleaned = cleaned.split(entity).join(char);
          }
          
          cleaned = cleaned.replace(/\s+/g, '');
          return cleaned;
        }
      
        addPage() {
          this.pageCounter++;
          const pageId = `page_${this.pageCounter}`;

          // Remove empty state on first page
          if (this.pageCounter === 1) {
            this.emptyState.style.display = 'none';
            this.addPageBtn.innerHTML = `
              <span style="font-size: 1.5rem;">‚ûï</span>
              <span>Add Another Page</span>
            `;
          }

          const pageForm = document.createElement("div");
          pageForm.className = "page-form-container";
          pageForm.setAttribute("data-page-id", pageId);
          pageForm.style.animation = "fadeInUp 0.3s ease";

          pageForm.innerHTML = `
            <div class="page-form-header">
              <div class="page-number-badge">${this.pageCounter}</div>
              <h3 class="page-form-title">Page ${this.pageCounter}</h3>
              ${this.pageCounter > 1 ? `
                <button type="button" class="remove-page-btn" onclick="modGenerator.removePage('${pageId}')">
                  <span>üóëÔ∏è</span>
                  <span>Remove Page</span>
                </button>
              ` : ''}
            </div>
            
            <div class="input-group">
              <label class="input-label">
                <span>üåê</span>
                <span>Page URL or Name</span>
              </label>
              <input 
                type="text" 
                class="input-field page-url" 
                placeholder="Example: https://www.example.com/about or just 'About Page'"
                data-page-id="${pageId}"
                required
              />
              <div class="input-hint">üí° You can paste a full URL or just enter a simple page name</div>
            </div>

            <div class="input-group">
              <label class="input-label">
                <span>‚úèÔ∏è</span>
                <span>What Did You Change?</span>
              </label>
              <textarea 
                class="input-field textarea-field page-changes" 
                placeholder="Example: Updated the hero banner image to showcase our new product line. Changed the headline from 'Welcome' to 'Discover Innovation'. Fixed the contact form validation issue that was preventing submissions."
                data-page-id="${pageId}"
                required
              ></textarea>
              <div class="input-hint">üí° Be specific! Describe all the changes you made on this page</div>
            </div>
          `;

          this.pagesContainer.appendChild(pageForm);

          // Focus on the URL input
          const urlInput = pageForm.querySelector(".page-url");
          setTimeout(() => {
            urlInput.focus();
            pageForm.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }, 100);
        }

        removePage(pageId) {
          const pageElement = document.querySelector(
            `[data-page-id="${pageId}"].page-form-container`
          );
          
          if (pageElement) {
            pageElement.style.opacity = '0';
            pageElement.style.transform = 'translateY(-20px)';
            
            setTimeout(() => {
              pageElement.remove();
              this.pageCounter--;

              // Show empty state if no pages
              if (this.pageCounter === 0) {
                this.emptyState.style.display = 'block';
                this.addPageBtn.innerHTML = `
                  <span style="font-size: 1.5rem;">‚ûï</span>
                  <span>Add Your First Page</span>
                `;
              } else {
                // Renumber remaining pages
                const remainingPages = this.pagesContainer.querySelectorAll('.page-form-container');
                remainingPages.forEach((page, index) => {
                  const badge = page.querySelector('.page-number-badge');
                  const title = page.querySelector('.page-form-title');
                  badge.textContent = index + 1;
                  title.textContent = `Page ${index + 1}`;
                });
              }
            }, 200);
          }
        }

        async handleSubmit(e) {
          e.preventDefault();

          if (!this.validateForm()) {
            return;
          }

          this.setGeneratingState(true);
          this.hideError();

          try {
            const formData = this.getFormData();
            console.log('Submitting form data:', formData);
            
            const results = await this.generateContent(formData);
            console.log('Received results:', results);
            
            this.showResults(results);
          } catch (error) {
            console.error("Generation error:", error);
            this.showError(error.message || 'Something went wrong. Please try again.');
          } finally {
            this.setGeneratingState(false);
          }
        }

        validateForm() {
          if (this.pageCounter === 0) {
            this.showError("üö® Oops! Please add at least one page first.");
            this.addPageBtn.focus();
            return false;
          }

          const pageContainers = this.pagesContainer.querySelectorAll('.page-form-container');
          
          for (let i = 0; i < pageContainers.length; i++) {
            const container = pageContainers[i];
            const urlInput = container.querySelector('.page-url');
            const changesInput = container.querySelector('.page-changes');
            
            if (!urlInput.value.trim()) {
              this.showError(`üö® Please enter a URL or page name for Page ${i + 1}`);
              urlInput.focus();
              container.scrollIntoView({ behavior: 'smooth', block: 'center' });
              return false;
            }

            if (!changesInput.value.trim()) {
              this.showError(`üö® Please describe what you changed on Page ${i + 1}`);
              changesInput.focus();
              container.scrollIntoView({ behavior: 'smooth', block: 'center' });
              return false;
            }
          }

          return true;
        }

        getFormData() {
          const data = { pages: [] };
          const pageContainers = this.pagesContainer.querySelectorAll('.page-form-container');

          pageContainers.forEach(container => {
            const urlInput = container.querySelector('.page-url');
            const changesInput = container.querySelector('.page-changes');
            
            // Sanitize URL before adding to data
            const sanitizedUrl = this.sanitizeUrlInput(urlInput.value.trim());
            const changes = changesInput.value.trim();

            if (sanitizedUrl && changes) {
              data.pages.push({
                url: sanitizedUrl,
                changes: [changes] // Wrap in array to match expected format
              });
            }
          });

          return data;
        }

        async generateContent(formData) {
          const response = await fetch(
            "https://worktoolshubv2.onrender.com/api/email/generate-offline-modifications",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(formData),
            }
          );

          if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.message || `Server error: ${response.status}`);
          }

          const result = await response.json();
          
          // Make sure we have the expected format
          if (!result.internalNote || !result.clientEmail) {
            console.error('Unexpected response format:', result);
            throw new Error('Invalid response format from server');
          }
          
          return result;
        }

        showResults(results) {
          console.log('Showing results:', results);
          
          // Set the content
          this.notePreview.textContent = results.internalNote;
          this.emailPreview.textContent = results.clientEmail;

          // Show the results container with the visible class
          this.resultsContainer.classList.add("visible");
          
          console.log('Results container classes:', this.resultsContainer.classList);
          console.log('Results container display:', window.getComputedStyle(this.resultsContainer).display);
          console.log('Results container opacity:', window.getComputedStyle(this.resultsContainer).opacity);

          // Scroll to results
          setTimeout(() => {
            this.resultsContainer.scrollIntoView({ 
              behavior: "smooth", 
              block: "start" 
            });
          }, 300);
        }

        setGeneratingState(isGenerating) {
          const btnContent = this.generateBtn.querySelector('.btn-content');
          const loadingSpinner = this.generateBtn.querySelector('.loading-spinner');
          
          if (isGenerating) {
            this.generateBtn.classList.add("is-generating");
            this.generateBtn.disabled = true;
            btnContent.style.display = 'none';
            loadingSpinner.style.display = 'flex';
            this.progressBar.classList.add("show");
          } else {
            this.generateBtn.classList.remove("is-generating");
            this.generateBtn.disabled = false;
            btnContent.style.display = 'flex';
            loadingSpinner.style.display = 'none';
            this.progressBar.classList.remove("show");
          }
        }

        showError(message) {
          this.errorMessage.textContent = message;
          this.errorMessage.classList.add("show");
          this.errorMessage.scrollIntoView({
            behavior: "smooth",
            block: "nearest",
          });
          
          // Auto-hide after 5 seconds
          setTimeout(() => {
            this.hideError();
          }, 5000);
        }

        hideError() {
          this.errorMessage.classList.remove("show");
        }

        async copyToClipboard(type) {
          try {
            const content =
              type === "note"
                ? this.notePreview.textContent
                : this.emailPreview.textContent;
            await navigator.clipboard.writeText(content);

            const btn = type === "note" ? this.copyNoteBtn : this.copyEmailBtn;
            const originalHTML = btn.innerHTML;

            btn.innerHTML = '<span>‚úÖ</span><span>Copied!</span>';
            btn.style.opacity = "0.8";

            setTimeout(() => {
              btn.innerHTML = originalHTML;
              btn.style.opacity = "";
            }, 2000);
          } catch (error) {
            console.error("Failed to copy:", error);
            this.showError("‚ùå Failed to copy. Please try selecting and copying manually.");
          }
        }
      }
       window.modGenerator = new OfflineModificationsGenerator();
  }
});
</script>

  </body>
</html>