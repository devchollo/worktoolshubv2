<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Primary Meta Tags -->
  <title>Free SSL Certificate Checker - Test SSL/TLS Security | WorkToolsHub</title>
  <meta name="title" content="Free SSL Certificate Checker - Test SSL/TLS Security | WorkToolsHub" />
  <meta name="description" content="Check SSL certificate security, TLS versions, browser compatibility, and device support. Test your website's SSL/TLS configuration across all platforms. Free SSL checker tool." />
  <meta name="keywords" content="SSL checker, TLS test, certificate checker, SSL security, TLS versions, browser compatibility, SSL certificate test, HTTPS checker, SSL Labs alternative" />
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="../../styles/main.css" />
  <link rel="stylesheet" href="../../styles/tools.css" />
  
  <style>
    .ssl-container {
      background: var(--surface-color);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-xl);
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--text-primary);
      font-size: 0.875rem;
    }

    .form-group input {
      width: 100%;
      padding: 0.875rem;
      border: 2px solid var(--border-color);
      border-radius: var(--radius-lg);
      font-size: 1rem;
      transition: all 0.2s ease;
      background: var(--bg-color);
      color: var(--text-primary);
    }

    .form-group input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .check-button {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: white;
      border: none;
      padding: 1rem 2rem;
      border-radius: var(--radius-lg);
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
    }

    .check-button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(37, 99, 235, 0.3);
    }

    .check-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .loading-container {
      background: var(--surface-color);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-xl);
      padding: 3rem 2rem;
      text-align: center;
      display: none;
    }

    .loading-container.show {
      display: block;
      animation: slideIn 0.4s ease;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(37, 99, 235, 0.1);
      border-top: 4px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .results-container {
      display: none;
    }

    .results-container.show {
      display: block;
      animation: slideIn 0.4s ease;
    }

    .grade-banner {
      background: var(--surface-color);
      border: 3px solid var(--border-color);
      border-radius: var(--radius-xl);
      padding: 2rem;
      margin-bottom: 2rem;
      text-align: center;
    }

    .grade-circle {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      margin: 0 auto 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      font-weight: 800;
      position: relative;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    }

    .grade-circle.a-plus { background: linear-gradient(135deg, #10b981, #059669); color: white; }
    .grade-circle.a { background: linear-gradient(135deg, #34d399, #10b981); color: white; }
    .grade-circle.b { background: linear-gradient(135deg, #fbbf24, #f59e0b); color: white; }
    .grade-circle.c { background: linear-gradient(135deg, #fb923c, #f97316); color: white; }
    .grade-circle.d { background: linear-gradient(135deg, #f87171, #ef4444); color: white; }
    .grade-circle.f { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }

    .grade-score {
      font-size: 1.25rem;
      color: var(--text-secondary);
      margin-bottom: 1rem;
    }

    .grade-description {
      font-size: 1rem;
      color: var(--text-secondary);
      max-width: 600px;
      margin: 0 auto;
    }

    .cert-details {
      background: var(--surface-color);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-xl);
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .cert-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .cert-item {
      background: var(--bg-color);
      padding: 1.25rem;
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-color);
    }

    .cert-label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
    }

    .cert-value {
      font-size: 0.9rem;
      color: var(--text-primary);
      word-break: break-word;
      font-weight: 500;
    }

    .tls-section {
      background: var(--surface-color);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-xl);
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .tls-grid {
      display: grid;
      gap: 1.5rem;
    }

    .tls-card {
      background: var(--bg-color);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
      transition: all 0.2s ease;
    }

    .tls-card.supported {
      border-color: #10b981;
    }

    .tls-card.deprecated {
      border-color: #f59e0b;
      background: rgba(251, 191, 36, 0.05);
    }

    .tls-card.unsupported {
      border-color: #ef4444;
      background: rgba(239, 68, 68, 0.05);
    }

    .tls-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .tls-version {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .tls-badge {
      padding: 0.375rem 0.875rem;
      border-radius: 50px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .tls-badge.supported {
      background: #d1fae5;
      color: #065f46;
    }

    .tls-badge.deprecated {
      background: #fef3c7;
      color: #92400e;
    }

    .tls-badge.unsupported {
      background: #fee2e2;
      color: #991b1b;
    }

    .tls-badge.recommended {
      background: #dbeafe;
      color: #1e40af;
    }

    .compat-section {
      margin-top: 1.5rem;
    }

    .compat-title {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.75rem;
    }

    .compat-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0.75rem;
    }

    .compat-item {
      background: var(--surface-color);
      padding: 0.75rem 1rem;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-color);
      font-size: 0.875rem;
    }

    .compat-name {
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.25rem;
    }

    .compat-version {
      color: var(--text-secondary);
      font-size: 0.75rem;
    }

    .recommendations {
      background: var(--surface-color);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-xl);
      padding: 2rem;
    }

    .rec-item {
      background: var(--bg-color);
      border-left: 4px solid;
      padding: 1.25rem;
      border-radius: var(--radius-md);
      margin-bottom: 1rem;
    }

    .rec-item:last-child {
      margin-bottom: 0;
    }

    .rec-item.high {
      border-color: #ef4444;
      background: rgba(239, 68, 68, 0.05);
    }

    .rec-item.medium {
      border-color: #f59e0b;
      background: rgba(251, 191, 36, 0.05);
    }

    .rec-item.low {
      border-color: #10b981;
      background: rgba(16, 185, 129, 0.05);
    }

    .rec-item.critical {
      border-color: #dc2626;
      background: rgba(220, 38, 38, 0.1);
    }

    .rec-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.5rem;
    }

    .rec-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.875rem;
      font-weight: 600;
    }

    .rec-icon.high {
      background: #fee2e2;
      color: #991b1b;
    }

    .rec-icon.medium {
      background: #fef3c7;
      color: #92400e;
    }

    .rec-icon.low {
      background: #d1fae5;
      color: #065f46;
    }

    .rec-icon.critical {
      background: #fecaca;
      color: #7f1d1d;
    }

    .rec-category {
      display: inline-block;
      padding: 0.25rem 0.625rem;
      background: var(--surface-color);
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
    }

    .rec-title {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 1rem;
    }

    .rec-description {
      color: var(--text-secondary);
      font-size: 0.875rem;
      line-height: 1.5;
      margin-bottom: 0.5rem;
    }

    .rec-action {
      color: var(--text-primary);
      font-size: 0.875rem;
      font-weight: 500;
      padding: 0.5rem 0.75rem;
      background: var(--surface-color);
      border-radius: 6px;
      margin-top: 0.5rem;
      border-left: 3px solid var(--primary-color);
    }

    .protocol-analysis {
      background: var(--surface-color);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-xl);
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .vulnerability-list {
      display: grid;
      gap: 1rem;
    }

    .vulnerability-item {
      background: var(--bg-color);
      border-left: 4px solid;
      padding: 1rem;
      border-radius: var(--radius-md);
    }

    .vulnerability-item.critical {
      border-color: #dc2626;
      background: rgba(220, 38, 38, 0.05);
    }

    .vulnerability-item.high {
      border-color: #ef4444;
      background: rgba(239, 68, 68, 0.05);
    }

    .vulnerability-item.medium {
      border-color: #f59e0b;
      background: rgba(251, 191, 36, 0.05);
    }

    .cipher-info {
      background: var(--surface-color);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-xl);
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .cipher-card {
      background: var(--bg-color);
      padding: 1.25rem;
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-color);
    }

    .status-message {
      padding: 1rem;
      border-radius: var(--radius-lg);
      margin-bottom: 1.5rem;
      text-align: center;
      font-weight: 500;
      display: none;
    }

    .status-message.show {
      display: block;
    }

    .status-message.error {
      background: #fee2e2;
      border: 2px solid #fecaca;
      color: #991b1b;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 768px) {
      .cert-grid {
        grid-template-columns: 1fr;
      }

      .compat-grid {
        grid-template-columns: 1fr;
      }

      .grade-circle {
        width: 120px;
        height: 120px;
        font-size: 3rem;
      }
    }
  </style>
</head>
<body>
  <div id="header"></div>

  <main>
    <section class="tool-container">
      <div class="tool-header">
        <h1>SSL Certificate Checker</h1>
        <p class="subtitle">
          Comprehensive SSL/TLS security analysis. Check certificate validity, TLS versions, 
          cipher suites, and compatibility across browsers and devices.
        </p>
      </div>

      <div class="form-container">
        <div class="ssl-container">
          <form id="sslForm">
            <div class="form-group">
              <label for="domain">Domain Name</label>
              <input 
                type="text" 
                id="domain" 
                placeholder="example.com or https://example.com" 
                required
              />
            </div>
            <button type="submit" class="check-button" id="checkButton">
              Check SSL Certificate
            </button>
          </form>
        </div>

        <div class="status-message" id="statusMessage"></div>
      </div>

      <div class="loading-container" id="loadingContainer">
        <div class="spinner"></div>
        <p class="loading-text">Analyzing SSL certificate and TLS configuration...</p>
      </div>

      <div class="results-container" id="resultsContainer">
        <!-- Grade Banner -->
        <div class="grade-banner" id="gradeBanner"></div>

        <!-- Certificate Details -->
        <div class="cert-details">
          <h3 style="margin-bottom: 1.5rem;">Certificate Information</h3>
          <div class="cert-grid" id="certGrid"></div>
        </div>

        <!-- Cipher Suite Info -->
        <div class="cipher-info">
          <h3 style="margin-bottom: 1.5rem;">Cipher Suite Analysis</h3>
          <div class="cipher-card" id="cipherCard"></div>
        </div>

        <!-- TLS Versions -->
        <div class="tls-section">
          <h3 style="margin-bottom: 1.5rem;">TLS Protocol Support</h3>
          <div class="tls-grid" id="tlsGrid"></div>
        </div>

        <!-- Protocol Analysis -->
        <div class="protocol-analysis" id="protocolAnalysis"></div>

        <!-- Recommendations -->
        <div class="recommendations">
          <h3 style="margin-bottom: 1.5rem;">Security Recommendations</h3>
          <div id="recommendationsContainer"></div>
        </div>
      </div>
    </section>
  </main>

  <div id="footer"></div>

  <script src="../../scripts/layout.js"></script>
  <script type="module" src="../../scripts/main.js" defer></script>
  <script src="/auth-utils.js"></script>
  <script src="../../scripts/footer.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      initializeTool();
    });

    function initializeTool() {
      class SSLChecker {
        constructor() {
          this.form = document.getElementById('sslForm');
          this.checkButton = document.getElementById('checkButton');
          this.loadingContainer = document.getElementById('loadingContainer');
          this.resultsContainer = document.getElementById('resultsContainer');
          this.statusMessage = document.getElementById('statusMessage');
          
          this.apiUrl = 'https://worktoolshubv2.onrender.com/api/ssl';
          
          this.init();
        }

        init() {
          this.bindEvents();
        }

        bindEvents() {
          this.form.addEventListener('submit', (e) => this.handleSubmit(e));
        }

        async handleSubmit(e) {
          e.preventDefault();
          
          const domain = document.getElementById('domain').value.trim();

          if (!domain) {
            this.showError('Please enter a domain name');
            return;
          }

          await this.checkSSL(domain);
        }

        async checkSSL(domain) {
          this.showLoading();
          this.hideError();
          this.hideResults();

          try {
            const response = await fetch(`${this.apiUrl}/check`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({ domain })
            });

            const data = await response.json();

            if (!response.ok) {
              throw new Error(data.message || data.error || 'Failed to check SSL');
            }

            this.displayResults(data);
          } catch (error) {
            console.error('SSL check error:', error);
            this.showError(error.message || 'Failed to check SSL certificate. Please verify the domain and try again.');
          } finally {
            this.hideLoading();
          }
        }

        displayResults(data) {
          this.resultsContainer.classList.add('show');

          // Display grade banner
          this.displayGradeBanner(data.grading, data.domain);

          // Display certificate details
          this.displayCertificate(data.certificate);

          // Display cipher suite info
          this.displayCipherInfo(data.certificate.cipher, data.cipherAnalysis);

          // Display TLS versions
          this.displayTLSVersions(data.tlsVersions);

          // Display protocol analysis
          if (data.protocolAnalysis) {
            this.displayProtocolAnalysis(data.protocolAnalysis);
          }

          // Display recommendations
          this.displayRecommendations(data.recommendations, data.grading.issues);
        }

        displayGradeBanner(grading, domain) {
          const gradeClass = grading.grade.toLowerCase().replace('+', '-plus');
          const descriptions = {
            'A+': 'Exceptional SSL/TLS configuration - exceeds industry standards',
            'A': 'Excellent SSL/TLS security configuration',
            'B': 'Good security with minor improvements recommended',
            'C': 'Fair security with several issues to address',
            'D': 'Poor security configuration - immediate action required',
            'E': 'Very poor security - critical vulnerabilities present',
            'F': 'Failing grade - critical security issues detected'
          };

          document.getElementById('gradeBanner').innerHTML = `
            <div class="grade-circle ${gradeClass}">
              ${grading.grade}
            </div>
            <div class="grade-score">
              Security Score: ${grading.score}/100 
              <span style="margin-left: 1rem; color: var(--text-secondary);">(${grading.securityLevel})</span>
            </div>
            <h2 style="margin-bottom: 0.5rem;">${domain}</h2>
            <p class="grade-description">${descriptions[grading.grade]}</p>
          `;
        }

        displayCertificate(cert) {
          const daysRemainingColor = cert.daysRemaining < 0 ? '#ef4444' : 
                                     cert.daysRemaining < 30 ? '#f59e0b' : '#10b981';

          // Format alt names
          const altNamesHtml = cert.subjectAltNames && cert.subjectAltNames.length > 0 
            ? cert.subjectAltNames.slice(0, 5).join(', ') + (cert.subjectAltNames.length > 5 ? '...' : '')
            : 'None';

          document.getElementById('certGrid').innerHTML = `
            <div class="cert-item">
              <div class="cert-label">Common Name</div>
              <div class="cert-value">${cert.subject.CN || 'N/A'}</div>
            </div>
            <div class="cert-item">
              <div class="cert-label">Issuer</div>
              <div class="cert-value">${cert.issuer.O || cert.issuer.CN || 'N/A'}</div>
            </div>
            <div class="cert-item">
              <div class="cert-label">Valid From</div>
              <div class="cert-value">${new Date(cert.validFrom).toLocaleDateString('en-US', { 
                year: 'numeric', month: 'short', day: 'numeric' 
              })}</div>
            </div>
            <div class="cert-item">
              <div class="cert-label">Valid Until</div>
              <div class="cert-value">${new Date(cert.validTo).toLocaleDateString('en-US', { 
                year: 'numeric', month: 'short', day: 'numeric' 
              })}</div>
            </div>
            <div class="cert-item">
              <div class="cert-label">Days Remaining</div>
              <div class="cert-value" style="color: ${daysRemainingColor}; font-weight: 600;">
                ${cert.daysRemaining} days ${cert.daysRemaining < 30 ? '‚ö†Ô∏è' : '‚úì'}
              </div>
            </div>
            <div class="cert-item">
              <div class="cert-label">Key Type & Size</div>
              <div class="cert-value">${cert.signatureAlgorithm} ${cert.keySize} bits</div>
            </div>
            <div class="cert-item">
              <div class="cert-label">Serial Number</div>
              <div class="cert-value" style="font-family: monospace; font-size: 0.75rem; word-break: break-all;">
                ${cert.serialNumber}
              </div>
            </div>
            <div class="cert-item">
              <div class="cert-label">Protocol</div>
              <div class="cert-value">${cert.protocol}</div>
            </div>
            <div class="cert-item" style="grid-column: 1 / -1;">
              <div class="cert-label">Alternative Names</div>
              <div class="cert-value" style="word-break: break-all;">
                ${altNamesHtml}
              </div>
            </div>
            <div class="cert-item" style="grid-column: 1 / -1;">
              <div class="cert-label">Fingerprint (SHA-256)</div>
              <div class="cert-value" style="font-family: monospace; font-size: 0.7rem; word-break: break-all;">
                ${cert.fingerprint256}
              </div>
            </div>
          `;
        }

        displayCipherInfo(cipher, analysis) {
          if (!cipher) {
            document.getElementById('cipherCard').innerHTML = `
              <p style="color: var(--text-secondary);">No cipher information available</p>
            `;
            return;
          }

          const ratingColors = {
            'A+': '#10b981',
            'A': '#10b981',
            'B': '#f59e0b',
            'C': '#fb923c',
            'D': '#f87171',
            'F': '#ef4444'
          };

          const detailsHtml = analysis.details ? `
            <div style="margin-top: 1rem; padding: 1rem; background: var(--surface-color); border-radius: 8px;">
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Forward Secrecy</div>
                  <div style="font-weight: 600; color: ${analysis.details.forwardSecrecy ? '#10b981' : '#ef4444'};">
                    ${analysis.details.forwardSecrecy ? '‚úì Yes' : '‚úó No'}
                  </div>
                </div>
                <div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">AEAD Mode</div>
                  <div style="font-weight: 600; color: ${analysis.details.aeadMode ? '#10b981' : '#f59e0b'};">
                    ${analysis.details.aeadMode ? '‚úì Yes' : '‚óã No'}
                  </div>
                </div>
                <div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Cipher Strength</div>
                  <div style="font-weight: 600;">${analysis.details.keySize} bits</div>
                </div>
              </div>
            </div>
          ` : '';

          document.getElementById('cipherCard').innerHTML = `
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
              <div>
                <div class="cert-label">Cipher Suite</div>
                <div class="cert-value" style="font-family: monospace; font-size: 0.875rem; word-break: break-all;">
                  ${cipher.name}
                </div>
              </div>
              <div>
                <div class="cert-label">Key Length</div>
                <div class="cert-value">${cipher.bits} bits</div>
              </div>
              <div>
                <div class="cert-label">Security Rating</div>
                <div class="cert-value" style="color: ${ratingColors[analysis.rating]}; font-weight: 700; font-size: 1.5rem;">
                  ${analysis.rating}
                </div>
              </div>
              <div>
                <div class="cert-label">Security Score</div>
                <div class="cert-value">${analysis.score}/100</div>
              </div>
            </div>
            ${detailsHtml}
            ${analysis.issues.length > 0 ? `
              <div style="margin-top: 1rem; padding: 1rem; background: rgba(239, 68, 68, 0.1); border-radius: 8px; border-left: 4px solid #ef4444;">
                <div style="font-weight: 600; color: #991b1b; margin-bottom: 0.5rem;">üî¥ Issues Detected:</div>
                ${analysis.issues.map(issue => `
                  <div style="color: #991b1b; font-size: 0.875rem; margin-bottom: 0.25rem;">‚Ä¢ ${issue}</div>
                `).join('')}
              </div>
            ` : ''}
            ${analysis.warnings && analysis.warnings.length > 0 ? `
              <div style="margin-top: 1rem; padding: 1rem; background: rgba(251, 191, 36, 0.1); border-radius: 8px; border-left: 4px solid #f59e0b;">
                <div style="font-weight: 600; color: #92400e; margin-bottom: 0.5rem;">‚ö†Ô∏è Warnings:</div>
                ${analysis.warnings.map(warning => `
                  <div style="color: #92400e; font-size: 0.875rem; margin-bottom: 0.25rem;">‚Ä¢ ${warning}</div>
                `).join('')}
              </div>
            ` : ''}
          `;
        }

        displayTLSVersions(versions) {
          const html = Object.values(versions).map(version => {
            const statusClass = version.supported ? 
              (version.name.includes('1.3') ? 'supported' : 
               version.name.includes('1.2') ? 'supported' : 'deprecated') : 
              'unsupported';

            const badgeClass = version.supported ?
              (version.name.includes('1.3') ? 'recommended' :
               version.name.includes('1.2') ? 'supported' : 'deprecated') :
              'unsupported';

            const badgeText = version.supported ?
              (version.name.includes('1.3') ? 'Recommended' :
               version.name.includes('1.2') ? 'Supported' : 'Deprecated') :
              'Not Supported';

            return `
              <div class="tls-card ${statusClass}">
                <div class="tls-header">
                  <div class="tls-version">${version.name}</div>
                  <div class="tls-badge ${badgeClass}">${badgeText}</div>
                </div>

                ${version.supported ? `
                  <div style="margin-bottom: 1rem;">
                    <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                      Protocol: <strong>${version.protocol || 'N/A'}</strong>
                    </div>
                  </div>

                  <div class="compat-section">
                    <div class="compat-title">Browser Compatibility</div>
                    <div class="compat-grid">
                      ${Object.entries(version.browserCompat || {}).map(([browser, info]) => `
                        <div class="compat-item">
                          <div class="compat-name">${browser}</div>
                          <div class="compat-version">
                            ${info.min ? `v${info.min}+` : 'Not supported'}
                          </div>
                        </div>
                      `).join('')}
                    </div>
                  </div>

                  <div class="compat-section">
                    <div class="compat-title">Device/OS Compatibility</div>
                    <div class="compat-grid">
                      ${Object.entries(version.deviceCompat || {}).map(([device, info]) => `
                        <div class="compat-item">
                          <div class="compat-name">${device}</div>
                          <div class="compat-version">
                            ${info.min ? `${info.min}+` : 'Not supported'}
                          </div>
                        </div>
                      `).join('')}
                    </div>
                  </div>
                ` : `
                  <div style="color: var(--text-secondary); font-size: 0.875rem;">
                    ${version.error || 'This TLS version is not supported on this server.'}
                  </div>
                `}
              </div>
            `;
          }).join('');

          document.getElementById('tlsGrid').innerHTML = html;
        }

        displayProtocolAnalysis(analysis) {
          const container = document.getElementById('protocolAnalysis');
          
          if (!analysis.vulnerabilities.length && !analysis.warnings.length) {
            container.style.display = 'none';
            return;
          }

          container.style.display = 'block';

          const vulnHtml = analysis.vulnerabilities.length > 0 ? `
            <div class="vulnerability-list">
              ${analysis.vulnerabilities.map(vuln => `
                <div class="vulnerability-item ${vuln.severity.toLowerCase()}">
                  <div style="display: flex; justify-content: between; align-items: start; margin-bottom: 0.75rem;">
                    <div style="flex: 1;">
                      <div style="font-weight: 600; color: var(--text-primary); font-size: 1rem; margin-bottom: 0.25rem;">
                        ${vuln.name}
                      </div>
                      <div style="display: inline-block; padding: 0.25rem 0.625rem; background: rgba(239, 68, 68, 0.1); border-radius: 4px; font-size: 0.75rem; font-weight: 600; color: #991b1b;">
                        ${vuln.severity}
                      </div>
                    </div>
                  </div>
                  <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.5rem;">
                    ${vuln.description}
                  </div>
                  ${vuln.cve ? `
                    <div style="color: var(--text-secondary); font-size: 0.75rem; margin-bottom: 0.5rem;">
                      <strong>CVE:</strong> ${vuln.cve.join(', ')}
                    </div>
                  ` : ''}
                  <div style="padding: 0.5rem 0.75rem; background: var(--surface-color); border-radius: 6px; border-left: 3px solid #ef4444; font-size: 0.875rem; color: var(--text-primary); font-weight: 500;">
                    üí° ${vuln.recommendation}
                  </div>
                </div>
              `).join('')}
            </div>
          ` : '';

          const warningsHtml = analysis.warnings.length > 0 ? `
            <div class="vulnerability-list" style="margin-top: ${analysis.vulnerabilities.length > 0 ? '1rem' : '0'};">
              ${analysis.warnings.map(warn => `
                <div class="vulnerability-item medium">
                  <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 0.5rem;">
                    ${warn.name}
                    <span style="display: inline-block; padding: 0.25rem 0.625rem; background: rgba(251, 191, 36, 0.1); border-radius: 4px; font-size: 0.75rem; font-weight: 600; color: #92400e; margin-left: 0.5rem;">
                      ${warn.severity}
                    </span>
                  </div>
                  <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.5rem;">
                    ${warn.description}
                  </div>
                  <div style="padding: 0.5rem 0.75rem; background: var(--surface-color); border-radius: 6px; border-left: 3px solid #f59e0b; font-size: 0.875rem; color: var(--text-primary); font-weight: 500;">
                    üí° ${warn.recommendation}
                  </div>
                </div>
              `).join('')}
            </div>
          ` : '';

          container.innerHTML = `
            <h3 style="margin-bottom: 1.5rem;">
              Security Analysis
              ${analysis.vulnerabilities.length > 0 ? `
                <span style="display: inline-block; padding: 0.375rem 0.875rem; background: #fee2e2; color: #991b1b; border-radius: 50px; font-size: 0.875rem; margin-left: 0.75rem;">
                  ${analysis.vulnerabilities.length} ${analysis.vulnerabilities.length === 1 ? 'Vulnerability' : 'Vulnerabilities'}
                </span>
              ` : ''}
            </h3>
            ${vulnHtml}
            ${warningsHtml}
          `;
        }

        displayRecommendations(recommendations, issues) {
          const container = document.getElementById('recommendationsContainer');

          if (recommendations.length === 0 && (!issues || issues.length === 0)) {
            container.innerHTML = `
              <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                <div style="font-size: 3rem; margin-bottom: 1rem;">‚úì</div>
                <div style="font-size: 1.125rem; font-weight: 600; color: var(--text-primary);">
                  Excellent Configuration
                </div>
                <div style="font-size: 0.875rem; margin-top: 0.5rem;">
                  Your SSL/TLS configuration follows security best practices
                </div>
              </div>
            `;
            return;
          }

          const severityOrder = { critical: 0, high: 1, medium: 2, low: 3 };
          const sortedRecs = [...recommendations].sort((a, b) => 
            severityOrder[a.severity] - severityOrder[b.severity]
          );

          container.innerHTML = sortedRecs.map(item => `
            <div class="rec-item ${item.severity}">
              <div class="rec-category">${item.category || 'General'}</div>
              <div class="rec-header">
                <div class="rec-icon ${item.severity}">!</div>
                <div class="rec-title">${item.issue}</div>
              </div>
              <div class="rec-description">${item.description}</div>
              ${item.action ? `
                <div class="rec-action">
                  <strong>Recommended Action:</strong> ${item.action}
                </div>
              ` : ''}
            </div>
          `).join('');
        }

        showLoading() {
          this.loadingContainer.classList.add('show');
          this.checkButton.disabled = true;
        }

        hideLoading() {
          this.loadingContainer.classList.remove('show');
          this.checkButton.disabled = false;
        }

        showError(message) {
          this.statusMessage.textContent = message;
          this.statusMessage.className = 'status-message error show';
        }

        hideError() {
          this.statusMessage.classList.remove('show');
        }

        hideResults() {
          this.resultsContainer.classList.remove('show');
        }
      }

      window.sslChecker = new SSLChecker();
    }
  </script>
</body>
</html>